{% comment %}
SECTION : Tous les avis clients – Metaobjects avec pagination (129+)
{% endcomment %}

{% assign all_reviews = shop.metaobjects.review.values %}

<div class="all-reviews" id="tous-les-avis">
  <div class="all-reviews-container">

    <h2 class="all-reviews-title">
      Tous les avis clients
    </h2>

    <p class="all-reviews-subtitle">
      {{ all_reviews.size }} avis laissés par plus de {{ section.settings.total_customers }} clients
    </p>

    {% paginate all_reviews by 12 %}
      <div class="all-reviews-list">
        {% for review in paginate.items %}
          <div class="all-review-item">

            <!-- ÉTOILES -->
            <div class="all-review-stars">
              {% for i in (1..5) %}
                {% if i <= review.note.value %}★{% else %}☆{% endif %}
              {% endfor %}
            </div>

            <!-- TEXTE -->
            <p class="all-review-text">
              {{ review.avis.value }}
            </p>

            <!-- FOOTER -->
            <div class="all-review-footer">
              <strong>{{ review.nom.value }}</strong>
              {% if review.achat_verifie.value %}
                <span class="verified">✔ Achat vérifié</span>
              {% endif %}
            </div>

          </div>
        {% endfor %}
      </div>

      {% if paginate.pages > 1 %}
        <div class="pagination">
          {% if paginate.previous %}
            <a href="{{ paginate.previous.url }}" class="page-btn">← Précédent</a>
          {% endif %}

          {% if paginate.next %}
            <a href="{{ paginate.next.url }}" class="page-btn">Charger plus</a>
          {% endif %}
        </div>
      {% endif %}
    {% endpaginate %}

  </div>
</div>

<style>
.all-reviews {
  padding: 48px 0;
  background: #fafafa;
}

.all-reviews-container {
  max-width: 900px;
  margin: auto;
  padding: 0 20px;
}

.all-reviews-title {
  text-align: center;
  font-size: 30px;
  margin-bottom: 10px;
}

.all-reviews-subtitle {
  text-align: center;
  font-size: 15px;
  color: #666;
  margin-bottom: 40px;
}

.all-reviews-list {
  display: flex;
  flex-direction: column;
  gap: 22px;
}

.all-review-item {
  background: #fff;
  border: 1px solid #e5e5e5;
  border-radius: 14px;
  padding: 22px;
}

.all-review-stars {
  color: #FFD700;
  font-size: 18px;
  margin-bottom: 10px;
  letter-spacing: 2px;
}

.all-review-text {
  font-size: 15px;
  line-height: 1.6;
  color: #333;
  margin-bottom: 12px;
}

.all-review-footer {
  font-size: 14px;
  color: #555;
}

.verified {
  color: #00A651;
  font-size: 12px;
  margin-left: 6px;
}

.pagination {
  margin-top: 40px;
  text-align: center;
}

.page-btn {
  display: inline-block;
  padding: 12px 28px;
  border: 2px solid #000;
  border-radius: 8px;
  text-decoration: none;
  color: #000;
  font-weight: 600;
}
</style>

{% schema %}
{
  "name": "Tous les avis clients",
  "settings": [
    {
      "type": "number",
      "id": "total_customers",
      "label": "Nombre total de clients",
      "default": 1800
    }
  ],
  "presets": [
    {
      "name": "Tous les avis clients"
    }
  ]
}
{% endschema %}
