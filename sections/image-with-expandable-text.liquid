{%- render 'section-properties' -%}

<div class="section-spacing {% if section.settings.separate_section_with_border %}bordered-section{% endif %}">
  <div class="container">
    <div class="v-stack gap-8">
      
      {%- comment -%} Image avec titre superpos√© {%- endcomment -%}
      <div class="image-with-text-overlay" style="position: relative;">
        {%- if section.settings.image != blank -%}
          {{- section.settings.image | image_url: width: 1500 | image_tag: loading: 'lazy', sizes: '100vw', widths: '400,600,800,1000,1200,1400,1600', class: 'rounded' -}}
        {%- else -%}
          {{- 'image' | placeholder_svg_tag: 'placeholder rounded' -}}
        {%- endif -%}
        
        {%- if section.settings.title != blank -%}
          <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 90%; color: {{ section.settings.text_color }}; text-shadow: 0 2px 10px rgba(0,0,0,0.5);">
            <h2 class="h1">{{ section.settings.title }}</h2>
          </div>
        {%- endif -%}
      </div>

      {%- comment -%} Texte extensible {%- endcomment -%}
      <div class="prose text-{{ section.settings.text_alignment }}">
        <details class="expandable-content">
          <summary class="link" style="cursor: pointer; list-style: none; display: inline-flex; align-items: center; gap: 8px;">
            {{ section.settings.button_text | default: "Lire plus" }}
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" style="transition: transform 0.3s;">
              <path d="M6 1L6 11M1 6L11 6" stroke="currentColor" stroke-width="1.5"/>
            </svg>
          </summary>
          <div class="expandable-text" style="margin-top: 1rem;">
            {{ section.settings.content }}
          </div>
        </details>
      </div>

    </div>
  </div>
</div>

<style>
  .expandable-content[open] summary svg {
    transform: rotate(45deg);
  }
  
  .expandable-content summary::-webkit-details-marker {
    display: none;
  }
</style>

{% schema %}
{
  "name": "Image + Lire plus",
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Titre",
      "default": "Notre histoire"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Couleur titre",
      "default": "#ffffff"
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "Contenu",
      "default": "<p>Texte ici...</p>"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Texte bouton",
      "default": "Lire plus"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Alignement",
      "options": [
        { "value": "start", "label": "Gauche" },
        { "value": "center", "label": "Centre" },
        { "value": "end", "label": "Droite" }
      ],
      "default": "start"
    },
    {
      "type": "checkbox",
      "id": "separate_section_with_border",
      "label": "Bordure",
      "default": false
    }
  ],
  "presets": [
    {
      "name": "Image + Lire plus"
    }
  ]
}
{% endschema %}
