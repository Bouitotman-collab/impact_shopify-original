{%- if section.settings.text != blank -%}
  {%- render 'section-spacing-collapsing' -%}

  <style>
    #shopify-section-{{ section.id }} {
      --section-spacing-inline: 0;
      width: 100vw !important;
      position: relative;
      left: 50%;
      margin-left: -50vw;
      margin-right: -50vw;
      height: 3rem; /* hauteur comme l’annonce bar */
      display: flex;
      align-items: center;
      overflow: hidden;
      background: {% if section.settings.background_gradient != blank %}{{ section.settings.background_gradient }}{% else %}{{ section.settings.background | default: '#000' }}{% endif %};
    }

    #shopify-section-{{ section.id }} .scrolling-text-wrapper {
      display: inline-block;
      white-space: nowrap;
      animation: scroll-text {{ section.settings.scroll_speed | default: 10 }}s linear infinite;
    }

    #shopify-section-{{ section.id }} .scrolling-text-wrapper span {
      display: inline-block;
      margin-right: 2rem;
      color: {% if section.settings.text_gradient != blank %}{{ section.settings.text_gradient }}{% else %}#F8F7F2{% endif %};
      font-weight: 400;
      font-size: {% if section.settings.text_size == 'xsmall' %}1.125rem{% elsif section.settings.text_size == 'small' %}2.5rem{% elsif section.settings.text_size == 'medium' %}3.75rem{% elsif section.settings.text_size == 'large' %}5rem{% else %}7.5rem{% endif %};
    }

    @media screen and (min-width: 700px) {
      #shopify-section-{{ section.id }} .scrolling-text-wrapper span {
        font-size: {% if section.settings.text_size == 'xsmall' %}1.5rem{% elsif section.settings.text_size == 'small' %}3.75rem{% elsif section.settings.text_size == 'medium' %}5rem{% elsif section.settings.text_size == 'large' %}8.75rem{% else %}12.5rem{% endif %};
      }
    }

    @keyframes scroll-text {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
  </style>

  <div {% render 'section-properties' %}>
    <div class="scrolling-text-wrapper">
      {%- for i in (1..20) -%}
        <span>{{ section.settings.text }}</span>
      {%- endfor -%}
    </div>
  </div>
{%- endif -%}

{% schema %}
{
  "name": "Scrolling Text Custom",
  "settings": [
    {
      "type": "text",
      "id": "text",
      "label": "Text",
      "default": "Promotion text"
    },
    {
      "type": "select",
      "id": "text_size",
      "label": "Text size",
      "options": [
        {"value": "xsmall","label": "X-Small"},
        {"value": "small","label": "Small"},
        {"value": "medium","label": "Medium"},
        {"value": "large","label": "Large"},
        {"value": "xlarge","label": "X-Large"}
      ],
      "default": "large"
    },
    {
      "type": "range",
      "id": "scroll_speed",
      "label": "Scrolling speed (seconds)",
      "min": 5,
      "max": 60,
      "step": 1,
      "default": 20,
      "unit": "s",
      "info": "Temps que met le texte pour défiler complètement."
    },
    {
      "type": "color",
      "id": "background",
      "label": "Background"
    },
    {
      "type": "color_background",
      "id": "background_gradient",
      "label": "Background gradient"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text"
    },
    {
      "type": "color_background",
      "id": "text_gradient",
      "label": "Text gradient"
    }
  ],
  "presets": [
    {
      "name": "Scrolling Text Custom"
    }
  ]
}
{% endschema %}
